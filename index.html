<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Brocki Buchsuche mit Open Library</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 650px; margin: 40px auto; padding:10px; }
    input, button { font-size:1.1em; padding:8px; margin-bottom:10px; width:100%; }
    #result { margin-top:20px; border-top:1px solid #ccc; padding-top:15px; }
    .book { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ddd; }
  </style>
</head>
<body>

<h1>üìö Brocki Buchsuche (Open Library API)</h1>

<input id="searchText" placeholder="ISBN, Titel oder Autor">
<button onclick="searchBook()">Suchen</button>

<div id="result"></div>

<script>
async function searchBook() {
  const query = document.getElementById("searchText").value.trim();
  const resDiv = document.getElementById("result");

  if (!query) {
    resDiv.innerHTML = "<p>Bitte zuerst etwas eingeben.</p>";
    return;
  }
  resDiv.innerHTML = "<p>üîç Suche l√§uft‚Ä¶</p>";

  try {
    // ======= Open Library Suche =======
    const resp = await fetch("https://openlibrary.org/search.json?q=" + encodeURIComponent(query));
    const data = await resp.json();

    if (!data.docs || data.docs.length === 0) {
      resDiv.innerHTML = "<p>‚ùå Keine B√ºcher gefunden.</p>";
      return;
    }

    // Nur die ersten 5 Ergebnisse anzeigen
    const books = data.docs.slice(0, 5);
    let html = "";

    books.forEach(book => {
      const title = book.title || "‚Äì";
      const author = book.author_name ? book.author_name.join(", ") : "‚Äì";
      const isbn = book.isbn ? book.isbn[0] : null;

      // Fiktiver Neupreis (kann sp√§ter aus Datenbank/JSON kommen)
      const neupreis = 25; // Beispiel CHF
      const verkaufspreis = (neupreis / 5).toFixed(2);

      html += `<div class="book">
        <h2>${title}</h2>
        <p><b>Autor:</b> ${author}</p>
        ${isbn ? `<p><b>ISBN:</b> ${isbn}</p>` : "<p>‚ö†Ô∏è Keine ISBN gefunden.</p>"}
        <p>üí∞ Preisvorschlag: <b>${verkaufspreis} CHF</b> (1/5 vom Neupreis)</p>
      </div>`;
    });

    resDiv.innerHTML = html;

  } catch (err) {
    console.error(err);
    resDiv.innerHTML = "<p>‚ö†Ô∏è Fehler bei der Suche.</p>";
  }
}

// ======= Enter-Taste aktiviert =======
document.getElementById("searchText").addEventListener("keydown", function(e) {
  if (e.key === "Enter") searchBook();
});
</script>

</body>
</html>
